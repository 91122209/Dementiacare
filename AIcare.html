<script>
  async function askGPT() {
    const question = document.getElementById('question').value.trim();
    const responseBox = document.getElementById('response');

    if (!question) {
      alert("請先輸入問題！");
      return;
    }

    responseBox.innerText = "AI 正在思考中……";

    try {
      const response = await fetch("/api/chat", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ question: question })
      });

      const data = await response.json();
      if (data && data.reply) {
        responseBox.innerText = data.reply;
      } else {
        responseBox.innerText = "AI 無法提供回覆，請稍後再試。";
      }
    } catch (err) {
      responseBox.innerText = "發生錯誤，請稍後再試。";
    }
  }

  function resetFields() {
    document.getElementById('question').value = '';
    document.getElementById('response').innerText = 'AI 將解答您的問題。';
  }

  document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("question");
    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault(); // 避免換行
        askGPT();
      }
    });
  });
</script>
